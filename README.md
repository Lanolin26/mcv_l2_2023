# mcv_l2_2023
# Лабораторная работа №2
## Вариант 4. Бинаризация grayscale изображения с фиксированным порогом

### Цель работы:
Изучить основы оптимизации и векторизации алгоритмов компьютерного зрения на базе процессорной системы ARM Cortex A57 MPCore + NEON. 

### Задание:
1. Разработать программу на C++, реализующую задание в соответствии с вариантом двумя способами: без использования векторных инструкций и с ними.
2. Оценить следующие характеристики:
   1. Зависимость производительности при изменении размера входных данных (размера изображения).
   2. Зависимость производительности от уровня оптимизации (флаги -O0, -O1, -O2, -O3) для варианта без векторных инструкций.
   3. Влияние ручной векторизации алгоритма на производительность. 

## Теоритическая база

Бинаризация - это процесс преобразования многозначных или непрерывных данных в бинарные, то есть в данные, которые принимают только два значения (обычно 0 и 1). Этот процесс часто используется в различных областях, таких как обработка изображений, распознавание образов и машинное обучение.

В контексте обработки изображений бинаризация обычно используется для улучшения контраста между объектами и фоном, выделения определенных объектов или улучшения качества изображения перед его дальнейшей обработкой. Для этого используются различные методы, такие как пороговая обработка, открытие и закрытие в морфологии изображений, а также адаптивная бинаризация.

Применительно к распознаванию образов и машинному обучению бинаризация может использоваться для упрощения данных и уменьшения размерности, что делает их более удобными для анализа и обучения моделей. Например, при решении задач классификации бинаризация позволяет преобразовать многоклассовую задачу в несколько бинарных задач, что может упростить процесс обучения и улучшить точность модели.

Важно отметить, что бинаризация не является обратимым процессом, и после ее применения исходное данные не могут быть восстановлены. 

## Описание разработанной системы

1.  Чтение изображения
2.  При бинаризации с использованием NEON
    1.  Последовательно берутся 16 пикселей из изображения в вектор.
    2.  Создается маска сравнения с вектором, в котором все значения равны фиксированному порогу.
    3.  По этой маске происходит замена значений пикселей на 0 или 255.
3.  При бинаризации без векторов
    1.  Последовательно проходятся все пиксели
    2.  Если значение пикселя меньше фиксированного значения, то он обнуляется, иначе его значение становится 255.
4.  Запись бинаризованного изображения.

## Результаты работы и тестирования системы

Количество повторений: 10

BIN 1 / BIN 2, где BIN 1 = циклы, BIN 2 = с использованием векторизации

|               | -O0                     | -O1                        | -O2                        | -O3                        |
|---------------|-------------------------|----------------------------|----------------------------|----------------------------|
| w=640 h=427   | 4.98002 ms / 0.70814 ms | 0.0991216 ms / 0.105815 ms | 0.106471 ms / 0.0931846 ms | 0.090778 ms / 0.0981427 ms |
| w=1280 h=853  | 18.559 ms / 2.8037 ms   | 0.42216 ms / 0.362684 ms   | 0.338783 ms / 0.463124 ms  | 0.329642 ms / 0.35307 ms   |
| w=1920 h=1280 | 41.0981 ms / 6.31816 ms | 0.782724 ms / 0.785125 ms  | 0.741239 ms / 0.869539 ms  | 0.749572 ms / 0.792693 ms  |
| w=2560 h=1600 | 68.276 ms / 10.7697 ms  | 1.39105 ms / 1.4442 ms     | 1.33086 ms / 1.35271 ms    | 1.27616 ms / 1.3629 ms     |
| w=3840 h=2160 | 140.72 ms / 21.9551 ms  | 2.82661 ms / 2.90376 ms    | 2.76477 ms / 2.87298 ms    | 2.6955 ms / 2.85653 ms     |


## Выводы по работе

В процессе выполнения данной лабораторной работы были исследованы варианты бинаризации grayscale изображения при помощи векторов ARN NEON и без них. В результате были получены метрики скорости обработки различных изображений на различных уровнях оптимизации кода для реализации с использованием векторизации и без нее. Данные метрики представлены в таблице в отчете.

## Использованные источники

1.  https://documentation-service.arm.com/static/63299276e68c6809a6b41308
2.  https://github.com/thenifty/neon-guide#neon-intrinsics-guide
3.  https://gcc.gnu.org/onlinedocs/gcc/gcc-command-options/machine-dependent-options/arm-options.html
4.  https://habr.com/ru/articles/278435/
